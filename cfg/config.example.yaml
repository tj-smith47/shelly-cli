# yaml-language-server: $schema=./config.schema.json
#
# Shelly CLI Configuration Example
# Copy this file to ~/.config/shelly/config.yaml and customize as needed.
#
# Run 'shelly init' for guided setup, or 'shelly init --check' to verify.

# =============================================================================
# Global Settings
# =============================================================================

# Output format: table, json, yaml, text, template
output: table

# Enable colored output (respects NO_COLOR env var)
color: true

# Color theme (280+ themes available, run 'shelly theme list' to see all)
# Popular choices: dracula, nord, tokyo-night, gruvbox, catppuccin, one-dark
#
# Simple format - just the theme name:
theme: dracula
#
# Block format - theme name with color overrides:
# theme:
#   name: dracula
#   colors:
#     green: "#50fa7b"
#     red: "#ff5555"
#
# External file format - load from a theme file:
# theme:
#   file: ~/.config/shelly/themes/my-theme.yaml
#
# Full custom format - only custom colors (no base theme):
# theme:
#   colors:
#     foreground: "#f8f8f2"
#     background: "#282a36"
#     green: "#50fa7b"
#     red: "#ff5555"
#     yellow: "#f1fa8c"
#     blue: "#6272a4"
#     cyan: "#8be9fd"
#     purple: "#bd93f9"
#     bright_black: "#6272a4"

# API mode: local (direct device access), cloud (via Shelly Cloud), auto
api_mode: local

# Verbosity level (0=silent, 1=info, 2=debug, 3=trace)
# Can also be set via -v/-vv/-vvv flags
verbosity: 0

# Suppress non-essential output
quiet: false

# =============================================================================
# Logging Settings (for debugging)
# =============================================================================

log:
  # Log output format: false=human-readable, true=JSON (for log aggregation)
  json: false

  # Filter logs by category (comma-separated)
  # Available: network, config, device, api, auth, plugin, discovery, firmware
  # Example: "network,api" to only see network and API logs
  # Leave empty to see all categories
  categories: ""

# =============================================================================
# Discovery Settings
# =============================================================================

discovery:
  # Discovery timeout
  timeout: 10s

  # Enable mDNS discovery (recommended for Gen2+ devices)
  mdns: true

  # Enable Bluetooth LE discovery
  ble: false

  # Enable CoIoT discovery (Gen1 devices)
  coiot: false

  # Default network for subnet scanning (CIDR notation)
  # network: 192.168.1.0/24

# =============================================================================
# Shelly Cloud Settings (optional)
# =============================================================================

cloud:
  # Enable cloud integration for remote access
  enabled: false

  # Cloud account email (set via 'shelly cloud login')
  # email: user@example.com

  # Tokens are managed automatically - do not edit manually
  # access_token: ""
  # refresh_token: ""

  # Cloud server URL (default is Shelly's production server)
  server_url: https://shelly-api.shelly.cloud

# =============================================================================
# Registered Devices
# =============================================================================

# Devices can be added via:
#   shelly device add <name> <address>
#   shelly discover mdns --register
#   shelly init (guided setup)

devices:
  # Example device entries:
  #
  # Native Shelly devices (platform defaults to "shelly"):
  #
  # kitchen-light:
  #   address: 192.168.1.50
  #   generation: 2
  #   type: switch
  #   model: SHSW-PM
  #
  # desk-lamp:
  #   address: 192.168.1.51
  #   generation: 2
  #   type: plug
  #   model: SHPLG-S
  #   auth:
  #     username: admin
  #     password: secret123
  #
  # living-room-dimmer:
  #   address: 192.168.1.52
  #   generation: 2
  #   type: light
  #   model: SHDM-2
  #
  # Plugin-managed devices (requires corresponding plugin installed):
  # Platform value maps to plugin name: "tasmota" -> "shelly-tasmota"
  #
  # garage-plug:
  #   address: 192.168.1.60
  #   platform: tasmota        # Managed by shelly-tasmota plugin
  #   type: switch
  #   model: "Sonoff Basic R3"

# =============================================================================
# Command Aliases
# =============================================================================

# Create shortcuts for frequently used commands.
# Use $1, $2, etc. for positional arguments, $@ for all arguments.

aliases:
  # Example aliases:
  #
  # lights-off:
  #   command: batch off kitchen-light living-room desk-lamp
  #
  # status:
  #   command: device list --output table
  #
  # morning:
  #   command: scene activate morning-routine
  #
  # # Shell alias (enables pipes and redirects)
  # backup-all:
  #   command: shelly backup create --all | gzip > ~/shelly-backup.gz
  #   shell: true

# =============================================================================
# Device Groups
# =============================================================================

# Group devices for batch operations:
#   shelly batch on --group living-room

groups:
  # Example groups:
  #
  # living-room:
  #   devices:
  #     - living-room-light
  #     - living-room-lamp
  #     - tv-backlight
  #
  # bedroom:
  #   devices:
  #     - bedroom-light
  #     - nightstand-lamp
  #
  # all-lights:
  #   devices:
  #     - kitchen-light
  #     - living-room-light
  #     - bedroom-light

# =============================================================================
# Scenes
# =============================================================================

# Save and recall device states:
#   shelly scene activate movie-time
#   shelly scene save current-state

scenes:
  # Example scenes:
  #
  # movie-time:
  #   description: Dim lights for movie watching
  #   actions:
  #     - device: living-room-dimmer
  #       method: Light.Set
  #       params:
  #         id: 0
  #         on: true
  #         brightness: 20
  #     - device: tv-backlight
  #       method: Light.Set
  #       params:
  #         id: 0
  #         on: true
  #         brightness: 50
  #
  # all-off:
  #   description: Turn off all lights
  #   actions:
  #     - device: kitchen-light
  #       method: Switch.Set
  #       params:
  #         id: 0
  #         on: false
  #     - device: living-room-light
  #       method: Switch.Set
  #       params:
  #         id: 0
  #         on: false

# =============================================================================
# Plugin Settings
# =============================================================================

plugins:
  # Enable plugin system
  enabled: false

  # Additional plugin search paths (beyond ~/.config/shelly/plugins)
  # path:
  #   - /usr/local/share/shelly/plugins
  #   - ~/my-shelly-plugins

# =============================================================================
# Rate Limiting Settings
# =============================================================================

# Rate limiting prevents overloading Shelly devices, which have hardware limits:
# - Gen1 (ESP8266): MAX 2 concurrent HTTP connections, easily overwhelmed
# - Gen2 (ESP32): MAX 5 concurrent HTTP transactions, more resilient

# These are the defaults - uncomment to customize:
# ratelimit:
#   gen1:
#     min_interval: 2s       # Minimum time between requests to same Gen1 device
#     max_concurrent: 1      # Max simultaneous requests per Gen1 device
#     circuit_threshold: 3   # Failures before circuit breaker opens
#   gen2:
#     min_interval: 500ms    # Gen2 can handle faster polling
#     max_concurrent: 3      # More headroom for Gen2
#     circuit_threshold: 5   # Gen2 is more resilient
#   global:
#     max_concurrent: 5           # Total concurrent requests across all devices
#     circuit_open_duration: 60s  # How long to back off unresponsive devices
#     circuit_success_threshold: 2 # Successes needed to close circuit

# =============================================================================
# TUI Dashboard Settings
# =============================================================================

tui:
  # Legacy: global refresh interval (deprecated, use 'refresh' below)
  # refresh_interval: 5

  # Adaptive refresh intervals based on device generation and state
  # Gen1 devices get longer intervals to avoid overwhelming them
  # Focused device (currently selected) refreshes faster for responsiveness
  #
  # These are the defaults - uncomment to customize:
  # refresh:
  #   gen1_online: 15s     # Online Gen1 devices (conservative)
  #   gen1_offline: 60s    # Offline Gen1 devices (don't hammer them)
  #   gen2_online: 5s      # Online Gen2 devices (handles faster polling)
  #   gen2_offline: 30s    # Offline Gen2 devices
  #   focused_boost: 3s    # Currently selected device gets priority

  # TUI-specific theme (independent - completely replaces main theme when set)
  # Supports same formats as main theme: string, block with colors, or file
  # theme: nord
  # theme:
  #   name: tokyo-night
  #   colors:
  #     green: "#9ece6a"

  # Custom keybindings (uncomment to override defaults)
  # keybindings:
  #   # Navigation (vim-style by default)
  #   up: [up, k]
  #   down: [down, j]
  #   left: [left, h]
  #   right: [right, l]
  #
  #   # Actions
  #   toggle: [space, t]
  #   turn_on: ["1", o]
  #   turn_off: ["0", x]
  #   refresh: [r, ctrl+r]
  #   filter: ["/"]
  #   command: [":"]
  #   help: ["?"]
  #   quit: [q, ctrl+c]
  #
  #   # View switching
  #   tab: [tab]
  #   shift_tab: [shift+tab]
  #   view1: ["1"]
  #   view2: ["2"]
  #   view3: ["3"]
  #   view4: ["4"]
