<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Contributing on Shelly CLI</title><link>http://localhost:1313/shelly-cli/docs/contributing/</link><description>Recent content in Contributing on Shelly CLI</description><generator>Hugo</generator><language>en-US</language><atom:link href="http://localhost:1313/shelly-cli/docs/contributing/index.xml" rel="self" type="application/rss+xml"/><item><title>Development Guide</title><link>http://localhost:1313/shelly-cli/docs/contributing/development/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://localhost:1313/shelly-cli/docs/contributing/development/</guid><description>&lt;p&gt;This document provides development standards and architectural patterns for the shelly-cli codebase. The first half covers practical coding standards; the second half provides reference patterns derived from audits of gh, kubectl, docker, jira-cli, gh-dash, and k9s.&lt;/p&gt;
&lt;h2 id="table-of-contents"&gt;Table of Contents&lt;/h2&gt;
&lt;h3 id="development-standards"&gt;Development Standards&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="#command-development-standards"&gt;Command Development Standards&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#factory-usage"&gt;Factory Usage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#iostreams-usage"&gt;IOStreams Usage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#error-handling"&gt;Error Handling&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#context-propagation"&gt;Context Propagation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#import-organization"&gt;Import Organization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#anti-patterns-to-avoid"&gt;Anti-Patterns to Avoid&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#migration-checklist"&gt;Migration Checklist&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#reference-implementations"&gt;Reference Implementations&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="reference-patterns"&gt;Reference Patterns&lt;/h3&gt;
&lt;ol start="10"&gt;
&lt;li&gt;&lt;a href="#factory-pattern"&gt;Factory Pattern (gh/kubectl)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#iostreams-pattern"&gt;IOStreams Pattern (gh)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#command-utilities"&gt;Command Utilities (gh/kubectl/jira-cli)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#directory-structure"&gt;Directory Structure&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#tui-architecture"&gt;TUI Architecture (gh-dash/BubbleTea)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#multi-writer-output-pattern"&gt;Multi-Writer Output Pattern&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#concurrency-patterns"&gt;Concurrency Patterns&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#testing-patterns"&gt;Testing Patterns&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h1 id="development-standards-1"&gt;Development Standards&lt;/h1&gt;
&lt;p&gt;These standards apply to all code in the shelly-cli repository.&lt;/p&gt;</description></item><item><title>Testing Strategy</title><link>http://localhost:1313/shelly-cli/docs/contributing/testing/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://localhost:1313/shelly-cli/docs/contributing/testing/</guid><description>&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Target Coverage:&lt;/strong&gt; 90%+ overall, with specific targets per package.
&lt;strong&gt;Reference:&lt;/strong&gt; gh CLI achieves ~80%+ coverage; kubectl ~70%+; we target 90%+ as a premium CLI.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="coverage-targets-by-package"&gt;Coverage Targets by Package&lt;/h2&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Package&lt;/th&gt;
 &lt;th&gt;Current&lt;/th&gt;
 &lt;th&gt;Target&lt;/th&gt;
 &lt;th&gt;Priority&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/model/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~100%&lt;/td&gt;
 &lt;td&gt;100%&lt;/td&gt;
 &lt;td&gt;Done&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/iostreams/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;0%&lt;/td&gt;
 &lt;td&gt;95%+&lt;/td&gt;
 &lt;td&gt;Critical&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/cmdutil/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;0%&lt;/td&gt;
 &lt;td&gt;95%+&lt;/td&gt;
 &lt;td&gt;Critical&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/config/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~60%&lt;/td&gt;
 &lt;td&gt;90%+&lt;/td&gt;
 &lt;td&gt;High&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/output/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~50%&lt;/td&gt;
 &lt;td&gt;90%+&lt;/td&gt;
 &lt;td&gt;High&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/client/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~5%&lt;/td&gt;
 &lt;td&gt;85%+&lt;/td&gt;
 &lt;td&gt;High&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/shelly/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~40%&lt;/td&gt;
 &lt;td&gt;85%+&lt;/td&gt;
 &lt;td&gt;High&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/plugins/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~30%&lt;/td&gt;
 &lt;td&gt;80%+&lt;/td&gt;
 &lt;td&gt;Medium&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/theme/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~50%&lt;/td&gt;
 &lt;td&gt;80%+&lt;/td&gt;
 &lt;td&gt;Medium&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/cmd/*/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;~20%&lt;/td&gt;
 &lt;td&gt;80%+&lt;/td&gt;
 &lt;td&gt;High&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;internal/tui/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;0%&lt;/td&gt;
 &lt;td&gt;75%+&lt;/td&gt;
 &lt;td&gt;Medium&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;code&gt;pkg/api/&lt;/code&gt;&lt;/td&gt;
 &lt;td&gt;0%&lt;/td&gt;
 &lt;td&gt;90%+&lt;/td&gt;
 &lt;td&gt;High (public)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="unit-tests"&gt;Unit Tests&lt;/h2&gt;
&lt;h3 id="iostreams-package-target-95"&gt;iostreams package (target: 95%+)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Test IOStreams creation with various terminal states&lt;/li&gt;
&lt;li&gt;Test color detection (TTY, NO_COLOR, FORCE_COLOR)&lt;/li&gt;
&lt;li&gt;Test progress indicator start/stop&lt;/li&gt;
&lt;li&gt;Test writer variants (Out, ErrOut)&lt;/li&gt;
&lt;li&gt;Test MultiWriter concurrent updates&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="cmdutil-package-target-95"&gt;cmdutil package (target: 95%+)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Test Factory initialization and lazy loading&lt;/li&gt;
&lt;li&gt;Test RunWithSpinner with success/error/cancel&lt;/li&gt;
&lt;li&gt;Test RunBatch with concurrent execution&lt;/li&gt;
&lt;li&gt;Test PrintResult with all output formats&lt;/li&gt;
&lt;li&gt;Test flag helpers&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="config-package-target-90"&gt;config package (target: 90%+)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Test config loading from various sources&lt;/li&gt;
&lt;li&gt;Test alias CRUD operations&lt;/li&gt;
&lt;li&gt;Test device registry operations&lt;/li&gt;
&lt;li&gt;Test scene management&lt;/li&gt;
&lt;li&gt;Test group management&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="output-package-target-90"&gt;output package (target: 90%+)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Test JSON/YAML/Table/Text formatters&lt;/li&gt;
&lt;li&gt;Test template rendering&lt;/li&gt;
&lt;li&gt;Test table column alignment&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-package-target-85"&gt;client package (target: 85%+)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Mock HTTP responses&lt;/li&gt;
&lt;li&gt;Test connection management&lt;/li&gt;
&lt;li&gt;Test error handling&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="command-packages-target-80"&gt;command packages (target: 80%+)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Table-driven tests for all commands&lt;/li&gt;
&lt;li&gt;Test flag parsing&lt;/li&gt;
&lt;li&gt;Test output formatting&lt;/li&gt;
&lt;li&gt;Test error conditions&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="integration-tests"&gt;Integration Tests&lt;/h2&gt;
&lt;h3 id="mock-device-server"&gt;Mock Device Server&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Create mock Shelly device using shelly-go testutil&lt;/li&gt;
&lt;li&gt;Support Gen1 and Gen2 API responses&lt;/li&gt;
&lt;li&gt;Simulate various device states&lt;/li&gt;
&lt;li&gt;Support WebSocket connections for events&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="workflow-tests"&gt;Workflow Tests&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Discovery → Add → Control → Status flow&lt;/li&gt;
&lt;li&gt;Backup → Modify → Restore flow&lt;/li&gt;
&lt;li&gt;Scene create → Activate → Delete flow&lt;/li&gt;
&lt;li&gt;Group create → Add devices → Batch control flow&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="tui-tests"&gt;TUI Tests&lt;/h3&gt;
&lt;p&gt;Use &lt;code&gt;charmbracelet/x/exp/teatest&lt;/code&gt; for TUI testing:&lt;/p&gt;</description></item></channel></rss>