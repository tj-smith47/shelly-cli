version: "2"

run:
  timeout: 5m
  concurrency: 4
  allow-parallel-runners: true

linters:
  exclusions:
    rules:
      # Allow "utils" package name - user-chosen name
      - path: 'internal/utils/.*\.go'
        linters:
          - revive
        text: 'var-naming: avoid meaningless package names'

  enable:
    # Core linters
    - errcheck
    - govet
    - unused
    - ineffassign
    - staticcheck

    # Style & complexity
    - goconst
    - gocritic
    - revive
    - gocyclo

    # Bug prevention
    - bodyclose
    - errorlint
    - nilerr
    - wastedassign
    - asciicheck
    - bidichk
    - copyloopvar
    - durationcheck
    - fatcontext
    - forcetypeassert
    - nilnil
    - noctx
    - reassign
    - recvcheck

    # Code quality
    - errname
    - exhaustive
    - gocheckcompilerdirectives
    - godot
    - intrange
    - misspell
    - nestif
    - nolintlint
    - prealloc
    - predeclared
    - unconvert
    - unparam
    - usestdlibvars
    - whitespace

    # Security
    - gosec

    # Testing
    - paralleltest
    - thelper
    - tparallel

  settings:
    errcheck:
      check-type-assertions: true
      check-blank: true

    errorlint:
      errorf: true
      asserts: true
      comparison: true

    gocritic:
      enabled-tags:
        - diagnostic
        - style
        - performance
        - opinionated
      disabled-checks:
        - hugeParam
        - rangeValCopy

    revive:
      severity: warning
      rules:
        - name: var-naming
          severity: warning
        - name: package-comments
          severity: warning
        - name: exported
          severity: warning

    gosec:
      severity: medium
      confidence: medium

    thelper:
      benchmark:
        first: true
        name: true
        begin: true
      fuzz:
        first: true
        name: true
        begin: true
      tb:
        first: true
        name: true
        begin: true

    gocyclo:
      min-complexity: 15

    paralleltest:
      ignore-missing: false
      ignore-missing-subtests: false

    goconst:
      min-len: 3
      min-occurrences: 3

    nestif:
      min-complexity: 4

    nolintlint:
      require-explanation: true
      require-specific: true

    exhaustive:
      default-signifies-exhaustive: true

formatters:
  enable:
    - gofmt
    - goimports
    - gci

  settings:
    goimports:
      local-prefixes:
        - github.com/tj-smith47/shelly-cli
    gci:
      sections:
        - standard
        - default
        - prefix(github.com/tj-smith47/shelly-cli)
